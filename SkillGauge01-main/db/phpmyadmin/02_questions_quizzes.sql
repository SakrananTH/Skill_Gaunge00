-- ===============================================================================
-- SkillGauge - คำถามและแบบทดสอบ (สำหรับ phpMyAdmin)
-- ===============================================================================

-- ส่วนที่ 1: หมวดหมู่คำถาม
-- ===============================================================================

-- ตาราง subcategories มีอยู่แล้วจาก migration 05_add_subcategory.sql
-- ถ้ายังไม่มีให้สร้าง
CREATE TABLE IF NOT EXISTS subcategories (
  id INT UNSIGNED NOT NULL AUTO_INCREMENT,
  category VARCHAR(120) NOT NULL COMMENT 'Parent category',
  `key` VARCHAR(100) NOT NULL COMMENT 'Unique identifier',
  label VARCHAR(255) NOT NULL COMMENT 'Display name in Thai',
  description TEXT NULL,
  question_count INT UNSIGNED NULL,
  percentage DECIMAL(5,2) NULL,
  display_order INT UNSIGNED NOT NULL DEFAULT 0,
  active TINYINT(1) NOT NULL DEFAULT 1,
  created_at DATETIME(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6),
  updated_at DATETIME(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
  PRIMARY KEY (id),
  UNIQUE KEY uq_subcategories_category_key (category, `key`),
  KEY idx_subcategories_category (category),
  KEY idx_subcategories_active (active)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

INSERT INTO subcategories (category, `key`, label, description, display_order, active) VALUES
  ('ช่างไฟฟ้า', 'safety', 'ความปลอดภัย', 'ความรู้เรื่องความปลอดภัยในงานไฟฟ้า', 1, 1),
  ('ช่างไฟฟ้า', 'theory', 'ทฤษฎีพื้นฐาน', 'ความรู้พื้นฐานเรื่องไฟฟ้า', 2, 1),
  ('ช่างไฟฟ้า', 'installation', 'การติดตั้ง', 'ทักษะการติดตั้งระบบไฟฟ้า', 3, 1),
  ('ช่างไฟฟ้า', 'maintenance', 'การซ่อมบำรุง', 'การแก้ไขและบำรุงรักษา', 4, 1),
  
  ('ช่างก่อสร้าง', 'safety', 'ความปลอดภัย', 'ความปลอดภัยในงานก่อสร้าง', 1, 1),
  ('ช่างก่อสร้าง', 'materials', 'วัสดุก่อสร้าง', 'ความรู้เรื่องวัสดุและคุณสมบัติ', 2, 1),
  ('ช่างก่อสร้าง', 'masonry', 'เทคนิคการก่อ', 'ทักษะการก่ออิฐและฉาบปูน', 3, 1),
  ('ช่างก่อสร้าง', 'concrete', 'งานคอนกรีต', 'การเทและบ่มคอนกรีต', 4, 1),
  
  ('ช่างประปา', 'safety', 'ความปลอดภัย', 'ความปลอดภัยในงานประปา', 1, 1),
  ('ช่างประปา', 'piping', 'ระบบท่อ', 'ความรู้เรื่องระบบท่อและการเชื่อมต่อ', 2, 1),
  ('ช่างประปา', 'fixtures', 'อุปกรณ์สุขภัณฑ์', 'การติดตั้งและซ่อมอุปกรณ์', 3, 1),
  
  ('ทั่วไป', 'safety', 'ความปลอดภัย', 'ความปลอดภัยทั่วไปในงานก่อสร้าง', 1, 1),
  ('ทั่วไป', 'labor_law', 'กฎหมายแรงงาน', 'กฎหมายและระเบียบที่เกี่ยวข้อง', 2, 1),
  ('ทั่วไป', 'benefits', 'สิทธิประโยชน์', 'สิทธิและสวัสดิการพนักงาน', 3, 1)
ON DUPLICATE KEY UPDATE description = VALUES(description);

-- ===============================================================================
-- ส่วนที่ 2: คำถาม (Questions)
-- ===============================================================================

-- คำถามด้านความปลอดภัยไฟฟ้า
INSERT INTO questions (id, text, category, difficulty, version, active) VALUES
  (UUID(), 'อุปกรณ์ป้องกันส่วนบุคคล (PPE) ใดที่จำเป็นที่สุดสำหรับช่างไฟฟ้า?', 'ช่างไฟฟ้า', 'easy', 'v1', 1),
  (UUID(), 'แรงดันไฟฟ้ากี่โวลต์ถือว่าอันตรายต่อชีวิต?', 'ช่างไฟฟ้า', 'medium', 'v1', 1),
  (UUID(), 'ก่อนเริ่มงานไฟฟ้าควรทำอย่างไร?', 'ช่างไฟฟ้า', 'easy', 'v1', 1),
  (UUID(), 'สายไฟสีเขียว-เหลือง ใช้สำหรับอะไร?', 'ช่างไฟฟ้า', 'easy', 'v1', 1),
  (UUID(), 'เครื่องตัดวงจร (Circuit Breaker) ทำงานเมื่อใด?', 'ช่างไฟฟ้า', 'medium', 'v1', 1),
  
  -- คำถามงานก่อสร้าง
  (UUID(), 'อัตราส่วนผสมคอนกรีตทั่วไปคือเท่าไร?', 'ช่างก่อสร้าง', 'medium', 'v1', 1),
  (UUID(), 'ระยะเวลาการบ่มคอนกรีตที่เหมาะสมคือกี่วัน?', 'ช่างก่อสร้าง', 'medium', 'v1', 1),
  (UUID(), 'วัสดุใดที่ใช้ก่ออิฐให้แข็งแรงที่สุด?', 'ช่างก่อสร้าง', 'easy', 'v1', 1),
  (UUID(), 'การทดสอบคอนกรีตด้วยค้อนตอก (Schmidt Hammer) วัดอะไร?', 'ช่างก่อสร้าง', 'hard', 'v1', 1),
  (UUID(), 'น้ำยาคอนกรีตเสริมแรง (Admixture) มีประโยชน์อย่างไร?', 'ช่างก่อสร้าง', 'medium', 'v1', 1),
  
  -- คำถามงานประปา
  (UUID(), 'ท่อ PVC ใช้สำหรับงานใด?', 'ช่างประปา', 'easy', 'v1', 1),
  (UUID(), 'ความดันน้ำมาตรฐานในระบบประปาควรเป็นเท่าไร?', 'ช่างประปา', 'medium', 'v1', 1),
  (UUID(), 'Plumber Tape ใช้ทำอะไร?', 'ช่างประปา', 'easy', 'v1', 1),
  (UUID(), 'วาล์วปิดน้ำหลักควรติดตั้งตรงไหน?', 'ช่างประปา', 'easy', 'v1', 1),
  (UUID(), 'ท่อน้ำทิ้งควรมีความลาดเอียงเท่าไร?', 'ช่างประปา', 'medium', 'v1', 1),
  
  -- คำถามทั่วไป
  (UUID(), 'เมื่อเกิดอุบัติเหตุในงานก่อสร้าง ควรทำอย่างไรก่อน?', 'ทั่วไป', 'easy', 'v1', 1),
  (UUID(), 'สัญลักษณ์สีเหลืองในงานก่อสร้างหมายถึงอะไร?', 'ทั่วไป', 'easy', 'v1', 1),
  (UUID(), 'นิสัยที่ดีของคนงานก่อสร้างมืออาชีพคืออะไร?', 'ทั่วไป', 'easy', 'v1', 1),
  (UUID(), 'พนักงานมีสิทธิ์ลาป่วยได้กี่วันต่อปี?', 'ทั่วไป', 'medium', 'v1', 1),
  (UUID(), 'การทำงานล่วงเวลาควรได้ค่าตอบแทนเพิ่มกี่เท่า?', 'ทั่วไป', 'medium', 'v1', 1)
ON DUPLICATE KEY UPDATE text = VALUES(text);

-- ===============================================================================
-- ส่วนที่ 3: แบบทดสอบ (Quizzes)
-- ===============================================================================

INSERT INTO quizzes (id, title, description, category, difficulty, question_count, passing_score, time_limit_minutes, status, created_by, created_at) VALUES
  (UUID(), 'แบบทดสอบช่างไฟฟ้าระดับพื้นฐาน', 'ทดสอบความรู้พื้นฐานสำหรับช่างไฟฟ้ามือใหม่', 'ช่างไฟฟ้า', 'easy', 20, 60.00, 30, 'approved', 'ผู้อบรม A', NOW()),
  
  (UUID(), 'แบบทดสอบช่างไฟฟ้าระดับกลาง', 'ทดสอบความรู้ระดับกลางสำหรับช่างไฟฟ้า', 'ช่างไฟฟ้า', 'medium', 30, 70.00, 45, 'approved', 'ผู้อบรม A', NOW()),
  
  (UUID(), 'แบบทดสอบความปลอดภัยในงานก่อสร้าง', 'ทดสอบความรู้ด้านความปลอดภัย', 'ทั่วไป', 'easy', 25, 80.00, 30, 'approved', 'ผู้อบรม B', NOW()),
  
  (UUID(), 'แบบทดสอบช่างก่อสร้างพื้นฐาน', 'ทดสอบทักษะการก่อสร้างพื้นฐาน', 'ช่างก่อสร้าง', 'easy', 25, 65.00, 40, 'approved', 'ผู้อบรม C', NOW()),
  
  (UUID(), 'แบบทดสอบช่างประปามืออาชีพ', 'ทดสอบทักษะช่างประปาระดับสูง', 'ช่างประปา', 'hard', 35, 75.00, 60, 'pending', 'ผู้อบรม D', NOW()),
  
  (UUID(), 'แบบทดสอบงานทาสีและตกแต่ง', 'ทดสอบความรู้เรื่องการทาสี', 'ช่างทาสี', 'medium', 20, 65.00, 30, 'pending', 'ผู้อบรม E', NOW()),
  
  (UUID(), 'แบบทดสอบงานเหล็กและเชื่อม', 'ทักษะการเชื่อมและประกอบโครงสร้างเหล็ก', 'ช่างเหล็ก', 'medium', 25, 70.00, 40, 'pending', 'ผู้อบรม F', NOW())
ON DUPLICATE KEY UPDATE title = VALUES(title);

-- ===============================================================================
-- ส่วนที่ 4: รอบการประเมิน (Assessment Rounds)
-- ===============================================================================

INSERT INTO assessment_rounds (id, title, category, description, question_count, start_at, end_at, status, created_at) VALUES
  (UUID(), 'การประเมินช่างไฟฟ้าประจำปี 2026', 'ช่างไฟฟ้า', 
   'การประเมินทักษะประจำปีสำหรับช่างไฟฟ้าทุกคน', 30, 
   '2026-01-01 00:00:00', '2026-12-31 23:59:59', 'active', NOW()),
  
  (UUID(), 'การประเมินความปลอดภัย Q1/2026', 'ทั่วไป',
   'การประเมินความรู้ด้านความปลอดภัยไตรมาสแรก', 25,
   '2026-01-01 00:00:00', '2026-03-31 23:59:59', 'active', NOW()),
  
  (UUID(), 'การประเมินช่างก่อสร้างรายเดือน', 'ช่างก่อสร้าง',
   'การประเมินทักษะประจำเดือนมกราคม', 20,
   '2026-01-01 00:00:00', '2026-01-31 23:59:59', 'active', NOW()),
  
  (UUID(), 'การประเมินพนักงานใหม่', 'ทั่วไป',
   'การประเมินสำหรับพนักงานที่ผ่านการทดลองงาน', 30,
   '2026-01-15 00:00:00', '2026-02-15 23:59:59', 'active', NOW()),
  
  (UUID(), 'การประเมินช่างประปา Q1/2026', 'ช่างประปา',
   'การประเมินทักษะช่างประปาไตรมาสที่ 1', 25,
   '2026-01-01 00:00:00', '2026-03-31 23:59:59', 'active', NOW())
ON DUPLICATE KEY UPDATE title = VALUES(title);

-- ===============================================================================
-- เสร็จสิ้น - คำถามและแบบทดสอบ
-- ===============================================================================
